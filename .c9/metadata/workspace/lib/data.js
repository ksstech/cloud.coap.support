{"filter":false,"title":"data.js","tooltip":"/lib/data.js","undoManager":{"mark":9,"position":9,"stack":[[{"group":"doc","deltas":[{"start":{"row":38,"column":0},"end":{"row":40,"column":32},"action":"remove","lines":["    orgs: db.collection('orgs'),","    events: db.collection('events'),","    data: db.collection('data'),"]}]}],[{"group":"doc","deltas":[{"start":{"row":38,"column":0},"end":{"row":39,"column":25},"action":"remove","lines":["","    authorize: authorize,"]}]}],[{"group":"doc","deltas":[{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":0},"end":{"row":49,"column":1},"action":"remove","lines":["function authorize(fromUuid, fromToken, callback){","    if(u.isAdmin(fromUuid, fromToken)) return callback(null,true);","    var devices = db.collection('devices');","    devices.findOne({uuid:fromUuid, token: fromToken}, function(err,device){","        if(err) return callback({code: 400, message: err});","        if(!device) return callback({code: 401, message: 'unauthorized'});","        else return callback(null,true);","    });","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":0},"end":{"row":42,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":0},"end":{"row":42,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":0},"end":{"row":47,"column":1},"action":"remove","lines":["function removeSensitiveDeviceData(device){","    delete device._id;","    delete device.timeStamp;","    delete device.online;","    delete device.token;","    return device;","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":0},"end":{"row":42,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":38,"column":0},"end":{"row":38,"column":56},"action":"remove","lines":["    removeSensitiveDeviceData: removeSensitiveDeviceData"]}]}],[{"group":"doc","deltas":[{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"remove","lines":["",""]}]}]]},"ace":{"folds":[],"scrolltop":360,"scrollleft":0,"selection":{"start":{"row":38,"column":0},"end":{"row":38,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1430238981500,"hash":"b25d752a4a78bd304558ae7e3ce33122b71ce060"}